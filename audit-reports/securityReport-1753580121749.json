{
  "reportMetadata": {
    "title": "PayroScore Security Assessment Report",
    "classification": "CONFIDENTIAL",
    "generateDate": "2025-07-27T01:35:21.749Z",
    "assessmentType": "Comprehensive Security Audit"
  },
  "executiveSummary": {
    "overallSecurityPosture": "CRITICAL RISK",
    "securityScore": 0,
    "complianceScore": 0,
    "immediateThreats": 5,
    "recommendedAction": "IMMEDIATE SECURITY REMEDIATION REQUIRED"
  },
  "threatAnalysis": {
    "authenticationThreats": [
      "Authorization bypass vulnerabilities",
      "Role escalation possibilities",
      "Insufficient access controls"
    ],
    "dataSecurityThreats": [
      "Sensitive data exposure",
      "Insufficient field-level access controls",
      "Potential data leakage between clients"
    ],
    "infrastructureThreats": [
      "API endpoints using HTTP instead of HTTPS",
      "Missing comprehensive audit logging",
      "Insufficient monitoring and alerting"
    ],
    "codeSecurityThreats": [
      "24 files with hardcoded secrets",
      "Unsafe operations detected",
      "Input validation gaps"
    ]
  },
  "vulnerabilityDetails": {
    "authenticationSecurity": {
      "unauthenticated_access_denial": {
        "success": true,
        "statusCode": 200,
        "hasErrors": true,
        "errors": [
          {
            "message": "Missing 'Authorization' or 'Cookie' header in JWT authentication mode",
            "extensions": {
              "path": "$",
              "code": "invalid-headers"
            }
          }
        ],
        "expectedToFail": true,
        "description": "Verify unauthenticated requests are denied",
        "securityOutcome": "secure"
      },
      "invalid_admin_secret": {
        "success": true,
        "statusCode": 200,
        "hasErrors": true,
        "errors": [
          {
            "message": "invalid x-hasura-admin-secret/x-hasura-access-key",
            "extensions": {
              "path": "$",
              "code": "access-denied"
            }
          }
        ],
        "expectedToFail": true,
        "description": "Verify invalid admin secret is rejected",
        "securityOutcome": "secure"
      },
      "valid_admin_access": {
        "success": true,
        "statusCode": 200,
        "hasErrors": false,
        "data": {
          "users": [
            {
              "id": "7898704c-ee5c-4ade-81f3-80a4388413fb",
              "name": "Test User",
              "email": "nathan.harris@invenco.net"
            }
          ]
        },
        "expectedToFail": false,
        "description": "Verify valid admin secret works",
        "securityOutcome": "secure"
      },
      "sql_injection_in_headers": {
        "success": true,
        "statusCode": 200,
        "hasErrors": false,
        "data": {
          "users": [
            {
              "id": "7898704c-ee5c-4ade-81f3-80a4388413fb",
              "name": "Test User"
            }
          ]
        },
        "expectedToFail": false,
        "description": "Test SQL injection attempts in headers",
        "securityOutcome": "secure"
      },
      "malformed_role_header": {
        "success": false,
        "statusCode": 200,
        "hasErrors": true,
        "errors": [
          {
            "message": "field 'users' not found in type: 'query_root'",
            "extensions": {
              "path": "$.selectionSet.users",
              "code": "validation-failed"
            }
          }
        ],
        "expectedToFail": false,
        "description": "Test malformed role header handling",
        "securityOutcome": "issue"
      }
    },
    "authorizationSecurity": {
      "viewer_restricted_access": {
        "success": false,
        "statusCode": 200,
        "hasErrors": false,
        "data": {
          "roles": [
            {
              "id": "7950e369-5257-4cc4-94ea-53ceecaf91a3",
              "name": "developer",
              "priority": 5
            },
            {
              "id": "7a21ecd4-3b83-447a-be0a-d0ca88290fd3",
              "name": "org_admin",
              "priority": 4
            },
            {
              "id": "39180393-6b3f-4db9-adb1-7f00e7cd5b7f",
              "name": "manager",
              "priority": 3
            },
            {
              "id": "64f5bc8d-aef6-4cc2-9aa2-170566d1af54",
              "name": "consultant",
              "priority": 2
            },
            {
              "id": "51a9454a-6961-4edb-a5eb-7d195eb3451d",
              "name": "viewer",
              "priority": 1
            }
          ]
        },
        "expectedToFail": true,
        "description": "Verify viewer role cannot access admin functions",
        "securityOutcome": "vulnerable"
      },
      "consultant_client_isolation": {
        "success": false,
        "statusCode": 200,
        "hasErrors": true,
        "errors": [
          {
            "message": "invalid input syntax for type uuid: \"test-consultant-id\"",
            "extensions": {
              "path": "$",
              "code": "data-exception"
            }
          }
        ],
        "expectedToFail": false,
        "description": "Test that consultant only sees appropriate data",
        "securityOutcome": "issue"
      },
      "role_escalation_attempt": {
        "success": true,
        "statusCode": 200,
        "hasErrors": true,
        "errors": [
          {
            "message": "invalid input syntax for type uuid: \"test-viewer-id\"",
            "extensions": {
              "path": "$",
              "code": "data-exception"
            }
          }
        ],
        "expectedToFail": true,
        "description": "Test prevention of role escalation",
        "securityOutcome": "secure"
      },
      "cross_tenant_data_access": {
        "success": false,
        "statusCode": 200,
        "hasErrors": true,
        "errors": [
          {
            "message": "invalid input syntax for type uuid: \"test-consultant-id\"",
            "extensions": {
              "path": "$",
              "code": "data-exception"
            }
          }
        ],
        "expectedToFail": false,
        "description": "Test data isolation between different organizational contexts",
        "securityOutcome": "issue"
      }
    },
    "graphqlSecurity": {
      "introspection_disabled": {
        "success": false,
        "statusCode": 200,
        "hasErrors": false,
        "data": {
          "__schema": {
            "types": [
              {
                "name": "AssignmentCalendarInput"
              },
              {
                "name": "AssignmentCalendarResponse"
              },
              {
                "name": "AssignmentDetails"
              },
              {
                "name": "AuditEventInput"
              },
              {
                "name": "AuditEventResponse"
              },
              {
                "name": "BigintComparisonExp"
              },
              {
                "name": "Boolean"
              },
              {
                "name": "BooleanComparisonExp"
              },
              {
                "name": "BpcharComparisonExp"
              },
              {
                "name": "CalendarDay"
              },
              {
                "name": "CapacitySummary"
              },
              {
                "name": "CursorOrdering"
              },
              {
                "name": "DateComparisonExp"
              },
              {
                "name": "Float"
              },
              {
                "name": "Int"
              },
              {
                "name": "IntComparisonExp"
              },
              {
                "name": "InvitationStatusEnumComparisonExp"
              },
              {
                "name": "JsonbCastExp"
              },
              {
                "name": "JsonbComparisonExp"
              },
              {
                "name": "LeaveResponse"
              },
              {
                "name": "LeaveStatusEnumComparisonExp"
              },
              {
                "name": "NameComparisonExp"
              },
              {
                "name": "NumericComparisonExp"
              },
              {
                "name": "OrderBy"
              },
              {
                "name": "PayrollCycleTypeComparisonExp"
              },
              {
                "name": "PayrollDateTypeComparisonExp"
              },
              {
                "name": "PayrollStatusComparisonExp"
              },
              {
                "name": "PermissionActionComparisonExp"
              },
              {
                "name": "String"
              },
              {
                "name": "StringArrayComparisonExp"
              },
              {
                "name": "StringComparisonExp"
              },
              {
                "name": "TimestampComparisonExp"
              },
              {
                "name": "TimestamptzComparisonExp"
              },
              {
                "name": "UserPositionComparisonExp"
              },
              {
                "name": "UserRoleComparisonExp"
              },
              {
                "name": "UtilizationStatsInput"
              },
              {
                "name": "UtilizationStatsResponse"
              },
              {
                "name": "UuidComparisonExp"
              },
              {
                "name": "WorkloadMetricsInput"
              },
              {
                "name": "WorkloadMetricsResponse"
              },
              {
                "name": "WorkloadPeriodData"
              },
              {
                "name": "_Any"
              },
              {
                "name": "_Entity"
              },
              {
                "name": "_Service"
              },
              {
                "name": "__Directive"
              },
              {
                "name": "__EnumValue"
              },
              {
                "name": "__Field"
              },
              {
                "name": "__InputValue"
              },
              {
                "name": "__Schema"
              },
              {
                "name": "__Type"
              },
              {
                "name": "__TypeKind"
              },
              {
                "name": "adjustmentRules"
              },
              {
                "name": "adjustmentRulesAggregateOrderBy"
              },
              {
                "name": "adjustmentRulesBoolExp"
              },
              {
                "name": "adjustmentRulesMaxOrderBy"
              },
              {
                "name": "adjustmentRulesMinOrderBy"
              },
              {
                "name": "adjustmentRulesOrderBy"
              },
              {
                "name": "adjustmentRulesSelectColumn"
              },
              {
                "name": "adjustmentRulesStreamCursorInput"
              },
              {
                "name": "adjustmentRulesStreamCursorValueInput"
              },
              {
                "name": "appSettings"
              },
              {
                "name": "appSettingsBoolExp"
              },
              {
                "name": "appSettingsOrderBy"
              },
              {
                "name": "appSettingsSelectColumn"
              },
              {
                "name": "appSettingsStreamCursorInput"
              },
              {
                "name": "appSettingsStreamCursorValueInput"
              },
              {
                "name": "auditLogs"
              },
              {
                "name": "auditLogsAggregate"
              },
              {
                "name": "auditLogsAggregateFields"
              },
              {
                "name": "auditLogsBoolExp"
              },
              {
                "name": "auditLogsMaxFields"
              },
              {
                "name": "auditLogsMinFields"
              },
              {
                "name": "auditLogsOrderBy"
              },
              {
                "name": "auditLogsSelectColumn"
              },
              {
                "name": "auditLogsStreamCursorInput"
              },
              {
                "name": "auditLogsStreamCursorValueInput"
              },
              {
                "name": "authEvents"
              },
              {
                "name": "authEventsAggregate"
              },
              {
                "name": "authEventsAggregateFields"
              },
              {
                "name": "authEventsBoolExp"
              },
              {
                "name": "authEventsMaxFields"
              },
              {
                "name": "authEventsMinFields"
              },
              {
                "name": "authEventsOrderBy"
              },
              {
                "name": "authEventsSelectColumn"
              },
              {
                "name": "authEventsStreamCursorInput"
              },
              {
                "name": "authEventsStreamCursorValueInput"
              },
              {
                "name": "bigint"
              },
              {
                "name": "billingEventLogs"
              },
              {
                "name": "billingEventLogsAggregateOrderBy"
              },
              {
                "name": "billingEventLogsBoolExp"
              },
              {
                "name": "billingEventLogsMaxOrderBy"
              },
              {
                "name": "billingEventLogsMinOrderBy"
              },
              {
                "name": "billingEventLogsOrderBy"
              },
              {
                "name": "billingEventLogsSelectColumn"
              },
              {
                "name": "billingEventLogsStreamCursorInput"
              },
              {
                "name": "billingEventLogsStreamCursorValueInput"
              },
              {
                "name": "billingInvoice"
              },
              {
                "name": "billingInvoiceAggregateOrderBy"
              },
              {
                "name": "billingInvoiceAvgOrderBy"
              },
              {
                "name": "billingInvoiceBoolExp"
              },
              {
                "name": "billingInvoiceItem"
              },
              {
                "name": "billingInvoiceItemAggregateOrderBy"
              },
              {
                "name": "billingInvoiceItemAvgOrderBy"
              },
              {
                "name": "billingInvoiceItemBoolExp"
              },
              {
                "name": "billingInvoiceItemMaxOrderBy"
              },
              {
                "name": "billingInvoiceItemMinOrderBy"
              },
              {
                "name": "billingInvoiceItemOrderBy"
              },
              {
                "name": "billingInvoiceItemSelectColumn"
              },
              {
                "name": "billingInvoiceItemStddevOrderBy"
              },
              {
                "name": "billingInvoiceItemStddevPopOrderBy"
              },
              {
                "name": "billingInvoiceItemStddevSampOrderBy"
              },
              {
                "name": "billingInvoiceItemStreamCursorInput"
              },
              {
                "name": "billingInvoiceItemStreamCursorValueInput"
              },
              {
                "name": "billingInvoiceItemSumOrderBy"
              },
              {
                "name": "billingInvoiceItemVarPopOrderBy"
              },
              {
                "name": "billingInvoiceItemVarSampOrderBy"
              },
              {
                "name": "billingInvoiceItemVarianceOrderBy"
              },
              {
                "name": "billingInvoiceMaxOrderBy"
              },
              {
                "name": "billingInvoiceMinOrderBy"
              },
              {
                "name": "billingInvoiceOrderBy"
              },
              {
                "name": "billingInvoiceSelectColumn"
              },
              {
                "name": "billingInvoiceStddevOrderBy"
              },
              {
                "name": "billingInvoiceStddevPopOrderBy"
              },
              {
                "name": "billingInvoiceStddevSampOrderBy"
              },
              {
                "name": "billingInvoiceStreamCursorInput"
              },
              {
                "name": "billingInvoiceStreamCursorValueInput"
              },
              {
                "name": "billingInvoiceSumOrderBy"
              },
              {
                "name": "billingInvoiceVarPopOrderBy"
              },
              {
                "name": "billingInvoiceVarSampOrderBy"
              },
              {
                "name": "billingInvoiceVarianceOrderBy"
              },
              {
                "name": "billingItems"
              },
              {
                "name": "billingItemsAggregateOrderBy"
              },
              {
                "name": "billingItemsAvgOrderBy"
              },
              {
                "name": "billingItemsBoolExp"
              },
              {
                "name": "billingItemsMaxOrderBy"
              },
              {
                "name": "billingItemsMinOrderBy"
              },
              {
                "name": "billingItemsOrderBy"
              },
              {
                "name": "billingItemsSelectColumn"
              },
              {
                "name": "billingItemsStddevOrderBy"
              },
              {
                "name": "billingItemsStddevPopOrderBy"
              },
              {
                "name": "billingItemsStddevSampOrderBy"
              },
              {
                "name": "billingItemsStreamCursorInput"
              },
              {
                "name": "billingItemsStreamCursorValueInput"
              },
              {
                "name": "billingItemsSumOrderBy"
              },
              {
                "name": "billingItemsVarPopOrderBy"
              },
              {
                "name": "billingItemsVarSampOrderBy"
              },
              {
                "name": "billingItemsVarianceOrderBy"
              },
              {
                "name": "billingPlans"
              },
              {
                "name": "billingPlansBoolExp"
              },
              {
                "name": "billingPlansOrderBy"
              },
              {
                "name": "billingPlansSelectColumn"
              },
              {
                "name": "billingPlansStreamCursorInput"
              },
              {
                "name": "billingPlansStreamCursorValueInput"
              },
              {
                "name": "bpchar"
              },
              {
                "name": "clientBillingAssignments"
              },
              {
                "name": "clientBillingAssignmentsAggregateOrderBy"
              },
              {
                "name": "clientBillingAssignmentsAvgOrderBy"
              },
              {
                "name": "clientBillingAssignmentsBoolExp"
              },
              {
                "name": "clientBillingAssignmentsMaxOrderBy"
              },
              {
                "name": "clientBillingAssignmentsMinOrderBy"
              },
              {
                "name": "clientBillingAssignmentsOrderBy"
              },
              {
                "name": "clientBillingAssignmentsSelectColumn"
              },
              {
                "name": "clientBillingAssignmentsStddevOrderBy"
              },
              {
                "name": "clientBillingAssignmentsStddevPopOrderBy"
              },
              {
                "name": "clientBillingAssignmentsStddevSampOrderBy"
              },
              {
                "name": "clientBillingAssignmentsStreamCursorInput"
              },
              {
                "name": "clientBillingAssignmentsStreamCursorValueInput"
              },
              {
                "name": "clientBillingAssignmentsSumOrderBy"
              },
              {
                "name": "clientBillingAssignmentsVarPopOrderBy"
              },
              {
                "name": "clientBillingAssignmentsVarSampOrderBy"
              },
              {
                "name": "clientBillingAssignmentsVarianceOrderBy"
              },
              {
                "name": "clientExternalSystems"
              },
              {
                "name": "clientExternalSystemsAggregateOrderBy"
              },
              {
                "name": "clientExternalSystemsBoolExp"
              },
              {
                "name": "clientExternalSystemsMaxOrderBy"
              },
              {
                "name": "clientExternalSystemsMinOrderBy"
              },
              {
                "name": "clientExternalSystemsOrderBy"
              },
              {
                "name": "clientExternalSystemsSelectColumn"
              },
              {
                "name": "clientExternalSystemsStreamCursorInput"
              },
              {
                "name": "clientExternalSystemsStreamCursorValueInput"
              },
              {
                "name": "clients"
              },
              {
                "name": "clientsAggregate"
              },
              {
                "name": "clientsAggregateBoolExp"
              },
              {
                "name": "clientsAggregateBoolExpBool_and"
              },
              {
                "name": "clientsAggregateBoolExpBool_or"
              },
              {
                "name": "clientsAggregateBoolExpCount"
              },
              {
                "name": "clientsAggregateFields"
              },
              {
                "name": "clientsAggregateOrderBy"
              },
              {
                "name": "clientsBoolExp"
              },
              {
                "name": "clientsMaxFields"
              },
              {
                "name": "clientsMaxOrderBy"
              },
              {
                "name": "clientsMinFields"
              },
              {
                "name": "clientsMinOrderBy"
              },
              {
                "name": "clientsOrderBy"
              },
              {
                "name": "clientsSelectColumn"
              },
              {
                "name": "clientsSelectColumnClientsAggregateBoolExpBool_andArgumentsColumns"
              },
              {
                "name": "clientsSelectColumnClientsAggregateBoolExpBool_orArgumentsColumns"
              },
              {
                "name": "clientsStreamCursorInput"
              },
              {
                "name": "clientsStreamCursorValueInput"
              },
              {
                "name": "createPayrollVersionArgs"
              },
              {
                "name": "createPayrollVersionSimpleArgs"
              },
              {
                "name": "currentPayrolls"
              },
              {
                "name": "currentPayrollsBoolExp"
              },
              {
                "name": "currentPayrollsOrderBy"
              },
              {
                "name": "currentPayrollsSelectColumn"
              },
              {
                "name": "currentPayrollsStreamCursorInput"
              },
              {
                "name": "currentPayrollsStreamCursorValueInput"
              },
              {
                "name": "date"
              },
              {
                "name": "externalSystems"
              },
              {
                "name": "externalSystemsBoolExp"
              },
              {
                "name": "externalSystemsOrderBy"
              },
              {
                "name": "externalSystemsSelectColumn"
              },
              {
                "name": "externalSystemsStreamCursorInput"
              },
              {
                "name": "externalSystemsStreamCursorValueInput"
              },
              {
                "name": "featureFlags"
              },
              {
                "name": "featureFlagsBoolExp"
              },
              {
                "name": "featureFlagsOrderBy"
              },
              {
                "name": "featureFlagsSelectColumn"
              },
              {
                "name": "featureFlagsStreamCursorInput"
              },
              {
                "name": "featureFlagsStreamCursorValueInput"
              },
              {
                "name": "generatePayrollDatesArgs"
              },
              {
                "name": "getLatestPayrollVersionArgs"
              },
              {
                "name": "getPayrollVersionHistoryArgs"
              },
              {
                "name": "holidays"
              },
              {
                "name": "holidaysBoolExp"
              },
              {
                "name": "holidaysOrderBy"
              },
              {
                "name": "holidaysSelectColumn"
              },
              {
                "name": "holidaysStreamCursorInput"
              },
              {
                "name": "holidaysStreamCursorValueInput"
              },
              {
                "name": "invitation_status_enum"
              },
              {
                "name": "json"
              },
              {
                "name": "jsonb"
              },
              {
                "name": "latestPayrollVersionResults"
              },
              {
                "name": "latestPayrollVersionResultsBoolExp"
              },
              {
                "name": "latestPayrollVersionResultsOrderBy"
              },
              {
                "name": "latestPayrollVersionResultsSelectColumn"
              },
              {
                "name": "latestPayrollVersionResultsStreamCursorInput"
              },
              {
                "name": "latestPayrollVersionResultsStreamCursorValueInput"
              },
              {
                "name": "leave"
              },
              {
                "name": "leaveAggregate"
              },
              {
                "name": "leaveAggregateBoolExp"
              },
              {
                "name": "leaveAggregateBoolExpCount"
              },
              {
                "name": "leaveAggregateFields"
              },
              {
                "name": "leaveAggregateOrderBy"
              },
              {
                "name": "leaveBoolExp"
              },
              {
                "name": "leaveConstraint"
              },
              {
                "name": "leaveInsertInput"
              },
              {
                "name": "leaveMaxFields"
              },
              {
                "name": "leaveMaxOrderBy"
              },
              {
                "name": "leaveMinFields"
              },
              {
                "name": "leaveMinOrderBy"
              },
              {
                "name": "leaveMutationResponse"
              },
              {
                "name": "leaveOnConflict"
              },
              {
                "name": "leaveOrderBy"
              },
              {
                "name": "leaveSelectColumn"
              },
              {
                "name": "leaveStreamCursorInput"
              },
              {
                "name": "leaveStreamCursorValueInput"
              },
              {
                "name": "leaveUpdateColumn"
              },
              {
                "name": "leave_status_enum"
              },
              {
                "name": "mutation_root"
              },
              {
                "name": "name"
              },
              {
                "name": "notes"
              },
              {
                "name": "notesAggregateOrderBy"
              },
              {
                "name": "notesBoolExp"
              },
              {
                "name": "notesConstraint"
              },
              {
                "name": "notesInsertInput"
              },
              {
                "name": "notesMaxOrderBy"
              },
              {
                "name": "notesMinOrderBy"
              },
              {
                "name": "notesMutationResponse"
              },
              {
                "name": "notesOnConflict"
              },
              {
                "name": "notesOrderBy"
              },
              {
                "name": "notesPkColumnsInput"
              },
              {
                "name": "notesSelectColumn"
              },
              {
                "name": "notesSetInput"
              },
              {
                "name": "notesStreamCursorInput"
              },
              {
                "name": "notesStreamCursorValueInput"
              },
              {
                "name": "notesUpdateColumn"
              },
              {
                "name": "notesUpdates"
              },
              {
                "name": "numeric"
              },
              {
                "name": "payrollActivationResults"
              },
              {
                "name": "payrollActivationResultsBoolExp"
              },
              {
                "name": "payrollActivationResultsOrderBy"
              },
              {
                "name": "payrollActivationResultsSelectColumn"
              },
              {
                "name": "payrollActivationResultsStreamCursorInput"
              },
              {
                "name": "payrollActivationResultsStreamCursorValueInput"
              },
              {
                "name": "payrollAssignmentAudits"
              },
              {
                "name": "payrollAssignmentAuditsAggregateOrderBy"
              },
              {
                "name": "payrollAssignmentAuditsBoolExp"
              },
              {
                "name": "payrollAssignmentAuditsMaxOrderBy"
              },
              {
                "name": "payrollAssignmentAuditsMinOrderBy"
              },
              {
                "name": "payrollAssignmentAuditsOrderBy"
              },
              {
                "name": "payrollAssignmentAuditsSelectColumn"
              },
              {
                "name": "payrollAssignmentAuditsStreamCursorInput"
              },
              {
                "name": "payrollAssignmentAuditsStreamCursorValueInput"
              },
              {
                "name": "payrollAssignments"
              },
              {
                "name": "payrollAssignmentsAggregateOrderBy"
              },
              {
                "name": "payrollAssignmentsBoolExp"
              },
              {
                "name": "payrollAssignmentsMaxOrderBy"
              },
              {
                "name": "payrollAssignmentsMinOrderBy"
              },
              {
                "name": "payrollAssignmentsOrderBy"
              },
              {
                "name": "payrollAssignmentsSelectColumn"
              },
              {
                "name": "payrollAssignmentsStreamCursorInput"
              },
              {
                "name": "payrollAssignmentsStreamCursorValueInput"
              },
              {
                "name": "payrollCycles"
              },
              {
                "name": "payrollCyclesBoolExp"
              },
              {
                "name": "payrollCyclesOrderBy"
              },
              {
                "name": "payrollCyclesSelectColumn"
              },
              {
                "name": "payrollCyclesStreamCursorInput"
              },
              {
                "name": "payrollCyclesStreamCursorValueInput"
              },
              {
                "name": "payrollDashboardStats"
              },
              {
                "name": "payrollDashboardStatsBoolExp"
              },
              {
                "name": "payrollDashboardStatsOrderBy"
              },
              {
                "name": "payrollDashboardStatsSelectColumn"
              },
              {
                "name": "payrollDashboardStatsStreamCursorInput"
              },
              {
                "name": "payrollDashboardStatsStreamCursorValueInput"
              },
              {
                "name": "payrollDateTypes"
              },
              {
                "name": "payrollDateTypesBoolExp"
              },
              {
                "name": "payrollDateTypesOrderBy"
              },
              {
                "name": "payrollDateTypesSelectColumn"
              },
              {
                "name": "payrollDateTypesStreamCursorInput"
              },
              {
                "name": "payrollDateTypesStreamCursorValueInput"
              },
              {
                "name": "payrollDates"
              },
              {
                "name": "payrollDatesAggregateOrderBy"
              },
              {
                "name": "payrollDatesBoolExp"
              },
              {
                "name": "payrollDatesMaxOrderBy"
              },
              {
                "name": "payrollDatesMinOrderBy"
              },
              {
                "name": "payrollDatesOrderBy"
              },
              {
                "name": "payrollDatesSelectColumn"
              },
              {
                "name": "payrollDatesStreamCursorInput"
              },
              {
                "name": "payrollDatesStreamCursorValueInput"
              },
              {
                "name": "payrollRequiredSkill"
              },
              {
                "name": "payrollRequiredSkillAggregateOrderBy"
              },
              {
                "name": "payrollRequiredSkillBoolExp"
              },
              {
                "name": "payrollRequiredSkillMaxOrderBy"
              },
              {
                "name": "payrollRequiredSkillMinOrderBy"
              },
              {
                "name": "payrollRequiredSkillOrderBy"
              },
              {
                "name": "payrollRequiredSkillSelectColumn"
              },
              {
                "name": "payrollRequiredSkillStreamCursorInput"
              },
              {
                "name": "payrollRequiredSkillStreamCursorValueInput"
              },
              {
                "name": "payrollTriggersStatus"
              },
              {
                "name": "payrollTriggersStatusBoolExp"
              },
              {
                "name": "payrollTriggersStatusOrderBy"
              },
              {
                "name": "payrollTriggersStatusSelectColumn"
              },
              {
                "name": "payrollTriggersStatusStreamCursorInput"
              },
              {
                "name": "payrollTriggersStatusStreamCursorValueInput"
              },
              {
                "name": "payrollVersionHistoryResults"
              },
              {
                "name": "payrollVersionHistoryResultsBoolExp"
              },
              {
                "name": "payrollVersionHistoryResultsOrderBy"
              },
              {
                "name": "payrollVersionHistoryResultsSelectColumn"
              },
              {
                "name": "payrollVersionHistoryResultsStreamCursorInput"
              },
              {
                "name": "payrollVersionHistoryResultsStreamCursorValueInput"
              },
              {
                "name": "payrollVersionResults"
              },
              {
                "name": "payrollVersionResultsBoolExp"
              },
              {
                "name": "payrollVersionResultsOrderBy"
              },
              {
                "name": "payrollVersionResultsSelectColumn"
              },
              {
                "name": "payrollVersionResultsStreamCursorInput"
              },
              {
                "name": "payrollVersionResultsStreamCursorValueInput"
              },
              {
                "name": "payroll_cycle_type"
              },
              {
                "name": "payroll_date_type"
              },
              {
                "name": "payroll_status"
              },
              {
                "name": "payrolls"
              },
              {
                "name": "payrollsAggregate"
              },
              {
                "name": "payrollsAggregateBoolExp"
              },
              {
                "name": "payrollsAggregateBoolExpCount"
              },
              {
                "name": "payrollsAggregateFields"
              },
              {
                "name": "payrollsAggregateOrderBy"
              },
              {
                "name": "payrollsAvgFields"
              },
              {
                "name": "payrollsAvgOrderBy"
              },
              {
                "name": "payrollsBoolExp"
              },
              {
                "name": "payrollsMaxFields"
              },
              {
                "name": "payrollsMaxOrderBy"
              },
              {
                "name": "payrollsMinFields"
              },
              {
                "name": "payrollsMinOrderBy"
              },
              {
                "name": "payrollsOrderBy"
              },
              {
                "name": "payrollsSelectColumn"
              },
              {
                "name": "payrollsStddevFields"
              },
              {
                "name": "payrollsStddevOrderBy"
              },
              {
                "name": "payrollsStddevPopFields"
              },
              {
                "name": "payrollsStddevPopOrderBy"
              },
              {
                "name": "payrollsStddevSampFields"
              },
              {
                "name": "payrollsStddevSampOrderBy"
              },
              {
                "name": "payrollsStreamCursorInput"
              },
              {
                "name": "payrollsStreamCursorValueInput"
              },
              {
                "name": "payrollsSumFields"
              },
              {
                "name": "payrollsSumOrderBy"
              },
              {
                "name": "payrollsVarPopFields"
              },
              {
                "name": "payrollsVarPopOrderBy"
              },
              {
                "name": "payrollsVarSampFields"
              },
              {
                "name": "payrollsVarSampOrderBy"
              },
              {
                "name": "payrollsVarianceFields"
              },
              {
                "name": "payrollsVarianceOrderBy"
              },
              {
                "name": "permissionAuditLogs"
              },
              {
                "name": "permissionAuditLogsAggregateOrderBy"
              },
              {
                "name": "permissionAuditLogsBoolExp"
              },
              {
                "name": "permissionAuditLogsMaxOrderBy"
              },
              {
                "name": "permissionAuditLogsMinOrderBy"
              },
              {
                "name": "permissionAuditLogsOrderBy"
              },
              {
                "name": "permissionAuditLogsSelectColumn"
              },
              {
                "name": "permissionAuditLogsStreamCursorInput"
              },
              {
                "name": "permissionAuditLogsStreamCursorValueInput"
              },
              {
                "name": "permissionOverrides"
              },
              {
                "name": "permissionOverridesAggregateOrderBy"
              },
              {
                "name": "permissionOverridesBoolExp"
              },
              {
                "name": "permissionOverridesMaxOrderBy"
              },
              {
                "name": "permissionOverridesMinOrderBy"
              },
              {
                "name": "permissionOverridesOrderBy"
              },
              {
                "name": "permissionOverridesSelectColumn"
              },
              {
                "name": "permissionOverridesStreamCursorInput"
              },
              {
                "name": "permissionOverridesStreamCursorValueInput"
              },
              {
                "name": "permission_action"
              },
              {
                "name": "permissions"
              },
              {
                "name": "permissionsAggregateOrderBy"
              },
              {
                "name": "permissionsBoolExp"
              },
              {
                "name": "permissionsMaxOrderBy"
              },
              {
                "name": "permissionsMinOrderBy"
              },
              {
                "name": "permissionsOrderBy"
              },
              {
                "name": "permissionsSelectColumn"
              },
              {
                "name": "permissionsStreamCursorInput"
              },
              {
                "name": "permissionsStreamCursorValueInput"
              },
              {
                "name": "query_root"
              },
              {
                "name": "resources"
              },
              {
                "name": "resourcesBoolExp"
              },
              {
                "name": "resourcesOrderBy"
              },
              {
                "name": "resourcesSelectColumn"
              },
              {
                "name": "resourcesStreamCursorInput"
              },
              {
                "name": "resourcesStreamCursorValueInput"
              },
              {
                "name": "rolePermissions"
              },
              {
                "name": "rolePermissionsAggregateOrderBy"
              },
              {
                "name": "rolePermissionsBoolExp"
              },
              {
                "name": "rolePermissionsMaxOrderBy"
              },
              {
                "name": "rolePermissionsMinOrderBy"
              },
              {
                "name": "rolePermissionsOrderBy"
              },
              {
                "name": "rolePermissionsSelectColumn"
              },
              {
                "name": "rolePermissionsStreamCursorInput"
              },
              {
                "name": "rolePermissionsStreamCursorValueInput"
              },
              {
                "name": "roles"
              },
              {
                "name": "rolesBoolExp"
              },
              {
                "name": "rolesOrderBy"
              },
              {
                "name": "rolesSelectColumn"
              },
              {
                "name": "rolesStreamCursorInput"
              },
              {
                "name": "rolesStreamCursorValueInput"
              },
              {
                "name": "subscription_root"
              },
              {
                "name": "timestamp"
              },
              {
                "name": "timestamptz"
              },
              {
                "name": "userInvitations"
              },
              {
                "name": "userInvitationsAggregate"
              },
              {
                "name": "userInvitationsAggregateBoolExp"
              },
              {
                "name": "userInvitationsAggregateBoolExpCount"
              },
              {
                "name": "userInvitationsAggregateFields"
              },
              {
                "name": "userInvitationsAggregateOrderBy"
              },
              {
                "name": "userInvitationsBoolExp"
              },
              {
                "name": "userInvitationsMaxFields"
              },
              {
                "name": "userInvitationsMaxOrderBy"
              },
              {
                "name": "userInvitationsMinFields"
              },
              {
                "name": "userInvitationsMinOrderBy"
              },
              {
                "name": "userInvitationsOrderBy"
              },
              {
                "name": "userInvitationsSelectColumn"
              },
              {
                "name": "userInvitationsStreamCursorInput"
              },
              {
                "name": "userInvitationsStreamCursorValueInput"
              },
              {
                "name": "userRoles"
              },
              {
                "name": "userRolesAggregateOrderBy"
              },
              {
                "name": "userRolesBoolExp"
              },
              {
                "name": "userRolesMaxOrderBy"
              },
              {
                "name": "userRolesMinOrderBy"
              },
              {
                "name": "userRolesOrderBy"
              },
              {
                "name": "userRolesSelectColumn"
              },
              {
                "name": "userRolesStreamCursorInput"
              },
              {
                "name": "userRolesStreamCursorValueInput"
              },
              {
                "name": "userSkill"
              },
              {
                "name": "userSkillAggregateOrderBy"
              },
              {
                "name": "userSkillBoolExp"
              },
              {
                "name": "userSkillMaxOrderBy"
              },
              {
                "name": "userSkillMinOrderBy"
              },
              {
                "name": "userSkillOrderBy"
              },
              {
                "name": "userSkillSelectColumn"
              },
              {
                "name": "userSkillStreamCursorInput"
              },
              {
                "name": "userSkillStreamCursorValueInput"
              },
              {
                "name": "user_position"
              },
              {
                "name": "user_role"
              },
              {
                "name": "users"
              },
              {
                "name": "usersAggregate"
              },
              {
                "name": "usersAggregateBoolExp"
              },
              {
                "name": "usersAggregateBoolExpBool_and"
              },
              {
                "name": "usersAggregateBoolExpBool_or"
              },
              {
                "name": "usersAggregateBoolExpCount"
              },
              {
                "name": "usersAggregateFields"
              },
              {
                "name": "usersAggregateOrderBy"
              },
              {
                "name": "usersAvgFields"
              },
              {
                "name": "usersAvgOrderBy"
              },
              {
                "name": "usersBoolExp"
              },
              {
                "name": "usersMaxFields"
              },
              {
                "name": "usersMaxOrderBy"
              },
              {
                "name": "usersMinFields"
              },
              {
                "name": "usersMinOrderBy"
              },
              {
                "name": "usersOrderBy"
              },
              {
                "name": "usersRoleBackup"
              },
              {
                "name": "usersRoleBackupBoolExp"
              },
              {
                "name": "usersRoleBackupOrderBy"
              },
              {
                "name": "usersSelectColumn"
              },
              {
                "name": "usersSelectColumnUsersAggregateBoolExpBool_andArgumentsColumns"
              },
              {
                "name": "usersSelectColumnUsersAggregateBoolExpBool_orArgumentsColumns"
              },
              {
                "name": "usersStddevFields"
              },
              {
                "name": "usersStddevOrderBy"
              },
              {
                "name": "usersStddevPopFields"
              },
              {
                "name": "usersStddevPopOrderBy"
              },
              {
                "name": "usersStddevSampFields"
              },
              {
                "name": "usersStddevSampOrderBy"
              },
              {
                "name": "usersStreamCursorInput"
              },
              {
                "name": "usersStreamCursorValueInput"
              },
              {
                "name": "usersSumFields"
              },
              {
                "name": "usersSumOrderBy"
              },
              {
                "name": "usersVarPopFields"
              },
              {
                "name": "usersVarPopOrderBy"
              },
              {
                "name": "usersVarSampFields"
              },
              {
                "name": "usersVarSampOrderBy"
              },
              {
                "name": "usersVarianceFields"
              },
              {
                "name": "usersVarianceOrderBy"
              },
              {
                "name": "uuid"
              },
              {
                "name": "workSchedule"
              },
              {
                "name": "workScheduleAggregate"
              },
              {
                "name": "workScheduleAggregateBoolExp"
              },
              {
                "name": "workScheduleAggregateBoolExpBool_and"
              },
              {
                "name": "workScheduleAggregateBoolExpBool_or"
              },
              {
                "name": "workScheduleAggregateBoolExpCount"
              },
              {
                "name": "workScheduleAggregateFields"
              },
              {
                "name": "workScheduleAggregateOrderBy"
              },
              {
                "name": "workScheduleAvgFields"
              },
              {
                "name": "workScheduleAvgOrderBy"
              },
              {
                "name": "workScheduleBoolExp"
              },
              {
                "name": "workScheduleMaxFields"
              },
              {
                "name": "workScheduleMaxOrderBy"
              },
              {
                "name": "workScheduleMinFields"
              },
              {
                "name": "workScheduleMinOrderBy"
              },
              {
                "name": "workScheduleOrderBy"
              },
              {
                "name": "workScheduleSelectColumn"
              },
              {
                "name": "workScheduleSelectColumnWorkScheduleAggregateBoolExpBool_andArgumentsColumns"
              },
              {
                "name": "workScheduleSelectColumnWorkScheduleAggregateBoolExpBool_orArgumentsColumns"
              },
              {
                "name": "workScheduleStddevFields"
              },
              {
                "name": "workScheduleStddevOrderBy"
              },
              {
                "name": "workScheduleStddevPopFields"
              },
              {
                "name": "workScheduleStddevPopOrderBy"
              },
              {
                "name": "workScheduleStddevSampFields"
              },
              {
                "name": "workScheduleStddevSampOrderBy"
              },
              {
                "name": "workScheduleStreamCursorInput"
              },
              {
                "name": "workScheduleStreamCursorValueInput"
              },
              {
                "name": "workScheduleSumFields"
              },
              {
                "name": "workScheduleSumOrderBy"
              },
              {
                "name": "workScheduleVarPopFields"
              },
              {
                "name": "workScheduleVarPopOrderBy"
              },
              {
                "name": "workScheduleVarSampFields"
              },
              {
                "name": "workScheduleVarSampOrderBy"
              },
              {
                "name": "workScheduleVarianceFields"
              },
              {
                "name": "workScheduleVarianceOrderBy"
              }
            ]
          }
        },
        "expectedToFail": true,
        "description": "Verify introspection is disabled for non-admin users",
        "securityOutcome": "vulnerable"
      },
      "query_depth_limiting": {
        "success": false,
        "statusCode": 200,
        "hasErrors": true,
        "errors": [
          {
            "message": "field 'rolePermissions' not found in type: 'roles'",
            "extensions": {
              "path": "$.selectionSet.users.selectionSet.assignedRoles.selectionSet.assignedRole.selectionSet.rolePermissions",
              "code": "validation-failed"
            }
          }
        ],
        "expectedToFail": false,
        "description": "Test query depth limiting",
        "securityOutcome": "issue"
      },
      "malicious_query_injection": {
        "success": true,
        "statusCode": 200,
        "hasErrors": false,
        "data": {
          "users": []
        },
        "expectedToFail": false,
        "description": "Test GraphQL injection attempts",
        "securityOutcome": "secure"
      },
      "field_access_controls": {
        "success": false,
        "statusCode": 200,
        "hasErrors": false,
        "data": {
          "users": [
            {
              "id": "7898704c-ee5c-4ade-81f3-80a4388413fb",
              "name": "Test User",
              "email": "nathan.harris@invenco.net",
              "role": "consultant",
              "clerkUserId": "user_2yXhEiNJEhLR25QDFnqD4dzpkkL"
            },
            {
              "id": "d9ac8a7b-f679-49a1-8c99-837eb977578b",
              "name": "Nathan Harris",
              "email": "nathan.harris02@gmail.com",
              "role": "developer",
              "clerkUserId": "user_2uNk3caC6G8tlohrgrkpwfzQwYv"
            },
            {
              "id": "3c2d1f6e-17a3-4a5f-8856-a2106456755c",
              "name": "Test Developer",
              "email": "developer@example.com",
              "role": "developer",
              "clerkUserId": "user_30Oc5BrHZvfnSZZHxvsQtqyenK0"
            },
            {
              "id": "9aed2a64-0407-4dff-a621-2b7013e1713a",
              "name": "John Admin",
              "email": "admin@example.com",
              "role": "org_admin",
              "clerkUserId": "user_2yXgxgRHxUilIyqE04jWreCRoO4"
            },
            {
              "id": "0727c441-3fa7-44c2-b8f3-4e0b77986ac1",
              "name": "Jane Manager",
              "email": "manager@example.com",
              "role": "manager",
              "clerkUserId": "user_2yXh2JHR2xtsfp16fkTdXHF9P3c"
            },
            {
              "id": "22a368d4-5d3f-4026-840c-55af6fb16972",
              "name": "Jim Consultant",
              "email": "consultant@example.com",
              "role": "consultant",
              "clerkUserId": "user_2yXh6Wu8FUd7VbPEB56M0XfXsio"
            },
            {
              "id": "e4313314-b89e-4346-9bb5-3aaf464c7152",
              "name": "Vera Viewer",
              "email": "viewer@example.com",
              "role": "viewer",
              "clerkUserId": "user_2yXhB08hGyXX7p8C8pWg5yPceIx"
            }
          ]
        },
        "expectedToFail": true,
        "description": "Test field-level access controls",
        "securityOutcome": "vulnerable"
      }
    },
    "dataAccessControls": {
      "user_data_isolation": {
        "success": false,
        "statusCode": 200,
        "hasErrors": true,
        "errors": [
          {
            "message": "invalid input syntax for type uuid: \"specific-user-id\"",
            "extensions": {
              "path": "$",
              "code": "data-exception"
            }
          }
        ],
        "expectedToFail": false,
        "description": "Test that users can only access their own data",
        "securityOutcome": "issue"
      },
      "sensitive_field_protection": {
        "success": false,
        "statusCode": 200,
        "hasErrors": false,
        "data": {
          "users": [
            {
              "id": "7898704c-ee5c-4ade-81f3-80a4388413fb",
              "clerkUserId": "user_2yXhEiNJEhLR25QDFnqD4dzpkkL",
              "managerId": null,
              "deactivatedBy": null
            },
            {
              "id": "d9ac8a7b-f679-49a1-8c99-837eb977578b",
              "clerkUserId": "user_2uNk3caC6G8tlohrgrkpwfzQwYv",
              "managerId": null,
              "deactivatedBy": null
            },
            {
              "id": "3c2d1f6e-17a3-4a5f-8856-a2106456755c",
              "clerkUserId": "user_30Oc5BrHZvfnSZZHxvsQtqyenK0",
              "managerId": null,
              "deactivatedBy": null
            },
            {
              "id": "9aed2a64-0407-4dff-a621-2b7013e1713a",
              "clerkUserId": "user_2yXgxgRHxUilIyqE04jWreCRoO4",
              "managerId": null,
              "deactivatedBy": null
            },
            {
              "id": "0727c441-3fa7-44c2-b8f3-4e0b77986ac1",
              "clerkUserId": "user_2yXh2JHR2xtsfp16fkTdXHF9P3c",
              "managerId": null,
              "deactivatedBy": null
            },
            {
              "id": "22a368d4-5d3f-4026-840c-55af6fb16972",
              "clerkUserId": "user_2yXh6Wu8FUd7VbPEB56M0XfXsio",
              "managerId": null,
              "deactivatedBy": null
            },
            {
              "id": "e4313314-b89e-4346-9bb5-3aaf464c7152",
              "clerkUserId": "user_2yXhB08hGyXX7p8C8pWg5yPceIx",
              "managerId": null,
              "deactivatedBy": null
            }
          ]
        },
        "expectedToFail": true,
        "description": "Test protection of sensitive user fields",
        "securityOutcome": "vulnerable"
      },
      "cross_client_data_leakage": {
        "success": false,
        "statusCode": 200,
        "hasErrors": true,
        "errors": [
          {
            "message": "invalid input syntax for type uuid: \"consultant-1\"",
            "extensions": {
              "path": "$",
              "code": "data-exception"
            }
          }
        ],
        "expectedToFail": false,
        "description": "Test for data leakage between different clients",
        "securityOutcome": "issue"
      },
      "administrative_data_protection": {
        "success": false,
        "statusCode": 200,
        "hasErrors": false,
        "data": {
          "roles": [
            {
              "id": "7950e369-5257-4cc4-94ea-53ceecaf91a3",
              "name": "developer",
              "priority": 5
            },
            {
              "id": "7a21ecd4-3b83-447a-be0a-d0ca88290fd3",
              "name": "org_admin",
              "priority": 4
            },
            {
              "id": "39180393-6b3f-4db9-adb1-7f00e7cd5b7f",
              "name": "manager",
              "priority": 3
            },
            {
              "id": "64f5bc8d-aef6-4cc2-9aa2-170566d1af54",
              "name": "consultant",
              "priority": 2
            },
            {
              "id": "51a9454a-6961-4edb-a5eb-7d195eb3451d",
              "name": "viewer",
              "priority": 1
            }
          ],
          "permissions": [
            {
              "action": "create"
            },
            {
              "action": "approve"
            },
            {
              "action": "approve"
            },
            {
              "action": "manage"
            },
            {
              "action": "create"
            },
            {
              "action": "approve"
            },
            {
              "action": "delete"
            },
            {
              "action": "create"
            },
            {
              "action": "update"
            },
            {
              "action": "read"
            },
            {
              "action": "create"
            },
            {
              "action": "update"
            },
            {
              "action": "delete"
            },
            {
              "action": "approve"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            },
            {
              "action": "read"
            },
            {
              "action": "reject"
            },
            {
              "action": "reject"
            },
            {
              "action": "reject"
            },
            {
              "action": "reject"
            },
            {
              "action": "reject"
            },
            {
              "action": "reject"
            },
            {
              "action": "reject"
            },
            {
              "action": "reject"
            },
            {
              "action": "reject"
            },
            {
              "action": "update"
            },
            {
              "action": "delete"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            },
            {
              "action": "read"
            },
            {
              "action": "create"
            },
            {
              "action": "update"
            },
            {
              "action": "delete"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            },
            {
              "action": "read"
            },
            {
              "action": "create"
            },
            {
              "action": "update"
            },
            {
              "action": "delete"
            },
            {
              "action": "approve"
            },
            {
              "action": "list"
            },
            {
              "action": "read"
            },
            {
              "action": "create"
            },
            {
              "action": "update"
            },
            {
              "action": "delete"
            },
            {
              "action": "approve"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            },
            {
              "action": "read"
            },
            {
              "action": "update"
            },
            {
              "action": "delete"
            },
            {
              "action": "approve"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            },
            {
              "action": "read"
            },
            {
              "action": "create"
            },
            {
              "action": "update"
            },
            {
              "action": "delete"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            },
            {
              "action": "read"
            },
            {
              "action": "create"
            },
            {
              "action": "update"
            },
            {
              "action": "approve"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            },
            {
              "action": "read"
            },
            {
              "action": "update"
            },
            {
              "action": "delete"
            },
            {
              "action": "approve"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            },
            {
              "action": "read"
            },
            {
              "action": "create"
            },
            {
              "action": "delete"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            },
            {
              "action": "reject"
            },
            {
              "action": "reject"
            },
            {
              "action": "reject"
            },
            {
              "action": "reject"
            },
            {
              "action": "reject"
            },
            {
              "action": "reject"
            },
            {
              "action": "reject"
            },
            {
              "action": "approve"
            },
            {
              "action": "read"
            },
            {
              "action": "create"
            },
            {
              "action": "update"
            },
            {
              "action": "delete"
            },
            {
              "action": "approve"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            },
            {
              "action": "read"
            },
            {
              "action": "create"
            },
            {
              "action": "update"
            },
            {
              "action": "delete"
            },
            {
              "action": "approve"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            },
            {
              "action": "read"
            },
            {
              "action": "create"
            },
            {
              "action": "update"
            },
            {
              "action": "delete"
            },
            {
              "action": "approve"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            },
            {
              "action": "read"
            },
            {
              "action": "create"
            },
            {
              "action": "update"
            },
            {
              "action": "delete"
            },
            {
              "action": "approve"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            },
            {
              "action": "read"
            },
            {
              "action": "create"
            },
            {
              "action": "update"
            },
            {
              "action": "delete"
            },
            {
              "action": "approve"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            },
            {
              "action": "read"
            },
            {
              "action": "create"
            },
            {
              "action": "update"
            },
            {
              "action": "delete"
            },
            {
              "action": "approve"
            },
            {
              "action": "list"
            },
            {
              "action": "manage"
            }
          ]
        },
        "expectedToFail": true,
        "description": "Test protection of administrative data",
        "securityOutcome": "vulnerable"
      }
    },
    "apiSecurityBoundaries": {},
    "sessionSecurity": {
      "missing_auth_headers": {
        "success": true,
        "statusCode": 200,
        "hasErrors": true,
        "errors": [
          {
            "message": "Missing 'Authorization' or 'Cookie' header in JWT authentication mode",
            "extensions": {
              "path": "$",
              "code": "invalid-headers"
            }
          }
        ],
        "expectedToFail": true,
        "description": "Test behavior with completely missing auth headers",
        "securityOutcome": "secure"
      },
      "partial_auth_headers": {
        "success": true,
        "statusCode": 200,
        "hasErrors": true,
        "errors": [
          {
            "message": "Missing 'Authorization' or 'Cookie' header in JWT authentication mode",
            "extensions": {
              "path": "$",
              "code": "invalid-headers"
            }
          }
        ],
        "expectedToFail": true,
        "description": "Test behavior with partial auth headers",
        "securityOutcome": "secure"
      },
      "header_injection_attempt": {
        "success": false,
        "error": "Invalid character in header content [\"x-hasura-role\"]",
        "expectedToFail": false,
        "description": "Test header injection attempts",
        "securityOutcome": "error"
      }
    },
    "informationDisclosure": {
      "error_message_information_leakage": {
        "success": true,
        "statusCode": 200,
        "hasErrors": true,
        "errors": [
          {
            "message": "field 'nonExistentTable' not found in type: 'query_root'",
            "extensions": {
              "path": "$.selectionSet.nonExistentTable",
              "code": "validation-failed"
            }
          }
        ],
        "expectedToFail": true,
        "description": "Test that error messages don't leak sensitive information",
        "securityOutcome": "secure"
      },
      "schema_exposure_prevention": {
        "success": false,
        "statusCode": 200,
        "hasErrors": false,
        "data": {
          "__type": {
            "fields": [
              {
                "name": "assignedRoles",
                "type": {
                  "name": null
                }
              },
              {
                "name": "authoredNotes",
                "type": {
                  "name": null
                }
              },
              {
                "name": "backupConsultantPayrolls",
                "type": {
                  "name": null
                }
              },
              {
                "name": "backupConsultantPayrollsAggregate",
                "type": {
                  "name": null
                }
              },
              {
                "name": "billingItems",
                "type": {
                  "name": null
                }
              },
              {
                "name": "billingItemsConfirmedBy",
                "type": {
                  "name": null
                }
              },
              {
                "name": "billingItemsUserId",
                "type": {
                  "name": null
                }
              },
              {
                "name": "clerkUserId",
                "type": {
                  "name": "String"
                }
              },
              {
                "name": "consultantAssignments",
                "type": {
                  "name": null
                }
              },
              {
                "name": "createdAssignmentAudits",
                "type": {
                  "name": null
                }
              },
              {
                "name": "createdAssignments",
                "type": {
                  "name": null
                }
              },
              {
                "name": "createdAt",
                "type": {
                  "name": "timestamptz"
                }
              },
              {
                "name": "createdBillingEvents",
                "type": {
                  "name": null
                }
              },
              {
                "name": "createdPermissionOverrides",
                "type": {
                  "name": null
                }
              },
              {
                "name": "deactivatedAt",
                "type": {
                  "name": "timestamptz"
                }
              },
              {
                "name": "deactivatedBy",
                "type": {
                  "name": "String"
                }
              },
              {
                "name": "defaultAdminTimePercentage",
                "type": {
                  "name": "numeric"
                }
              },
              {
                "name": "email",
                "type": {
                  "name": null
                }
              },
              {
                "name": "id",
                "type": {
                  "name": null
                }
              },
              {
                "name": "image",
                "type": {
                  "name": "String"
                }
              },
              {
                "name": "isActive",
                "type": {
                  "name": "Boolean"
                }
              },
              {
                "name": "isStaff",
                "type": {
                  "name": "Boolean"
                }
              },
              {
                "name": "managedPayrolls",
                "type": {
                  "name": null
                }
              },
              {
                "name": "managedPayrollsAggregate",
                "type": {
                  "name": null
                }
              },
              {
                "name": "managedTeamMembers",
                "type": {
                  "name": null
                }
              },
              {
                "name": "managedTeamMembersAggregate",
                "type": {
                  "name": null
                }
              },
              {
                "name": "managedUsers",
                "type": {
                  "name": null
                }
              },
              {
                "name": "managedUsersAggregate",
                "type": {
                  "name": null
                }
              },
              {
                "name": "managerId",
                "type": {
                  "name": "uuid"
                }
              },
              {
                "name": "managerUser",
                "type": {
                  "name": "users"
                }
              },
              {
                "name": "name",
                "type": {
                  "name": null
                }
              },
              {
                "name": "newConsultantAuditTrail",
                "type": {
                  "name": null
                }
              },
              {
                "name": "originalConsultantAssignments",
                "type": {
                  "name": null
                }
              },
              {
                "name": "originalConsultantAuditTrail",
                "type": {
                  "name": null
                }
              },
              {
                "name": "position",
                "type": {
                  "name": "user_position"
                }
              },
              {
                "name": "primaryConsultantPayrolls",
                "type": {
                  "name": null
                }
              },
              {
                "name": "primaryConsultantPayrollsAggregate",
                "type": {
                  "name": null
                }
              },
              {
                "name": "role",
                "type": {
                  "name": null
                }
              },
              {
                "name": "statusChangedByUser",
                "type": {
                  "name": "users"
                }
              },
              {
                "name": "targetedPermissionAudits",
                "type": {
                  "name": null
                }
              },
              {
                "name": "updatedAt",
                "type": {
                  "name": "timestamptz"
                }
              },
              {
                "name": "userInvitations",
                "type": {
                  "name": null
                }
              },
              {
                "name": "userInvitationsAcceptedBy",
                "type": {
                  "name": null
                }
              },
              {
                "name": "userInvitationsAcceptedByAggregate",
                "type": {
                  "name": null
                }
              },
              {
                "name": "userInvitationsAggregate",
                "type": {
                  "name": null
                }
              },
              {
                "name": "userInvitationsInvitedBy",
                "type": {
                  "name": null
                }
              },
              {
                "name": "userInvitationsInvitedByAggregate",
                "type": {
                  "name": null
                }
              },
              {
                "name": "userInvitationsManagerId",
                "type": {
                  "name": null
                }
              },
              {
                "name": "userInvitationsManagerIdAggregate",
                "type": {
                  "name": null
                }
              },
              {
                "name": "userLeaveRecords",
                "type": {
                  "name": null
                }
              },
              {
                "name": "userLeaveRecordsAggregate",
                "type": {
                  "name": null
                }
              },
              {
                "name": "userPermissionAudits",
                "type": {
                  "name": null
                }
              },
              {
                "name": "userPermissionOverrides",
                "type": {
                  "name": null
                }
              },
              {
                "name": "userSkills",
                "type": {
                  "name": null
                }
              },
              {
                "name": "userWorkSchedules",
                "type": {
                  "name": null
                }
              },
              {
                "name": "userWorkSchedulesAggregate",
                "type": {
                  "name": null
                }
              },
              {
                "name": "username",
                "type": {
                  "name": "String"
                }
              },
              {
                "name": "usersStatusChangedBy",
                "type": {
                  "name": null
                }
              },
              {
                "name": "usersStatusChangedByAggregate",
                "type": {
                  "name": null
                }
              }
            ]
          }
        },
        "expectedToFail": true,
        "description": "Test that schema details are not exposed to unauthorized users",
        "securityOutcome": "vulnerable"
      },
      "internal_field_exposure": {
        "success": false,
        "statusCode": 200,
        "hasErrors": true,
        "errors": [
          {
            "message": "missing session variable: \"x-hasura-user-id\"",
            "extensions": {
              "path": "$",
              "code": "not-found"
            }
          }
        ],
        "expectedToFail": false,
        "description": "Test that internal system fields are not exposed",
        "securityOutcome": "issue"
      }
    },
    "auditTrailSecurity": {},
    "summary": {
      "totalTests": 23,
      "passedTests": 10,
      "failedTests": 13,
      "criticalFindings": [
        {
          "type": "authorization_bypass",
          "test": "viewer_restricted_access",
          "description": "Verify viewer role cannot access admin functions"
        },
        {
          "type": "graphql_security",
          "test": "introspection_disabled",
          "description": "Verify introspection is disabled for non-admin users"
        },
        {
          "type": "graphql_security",
          "test": "field_access_controls",
          "description": "Test field-level access controls"
        },
        {
          "type": "data_access_bypass",
          "test": "sensitive_field_protection",
          "description": "Test protection of sensitive user fields"
        },
        {
          "type": "data_access_bypass",
          "test": "administrative_data_protection",
          "description": "Test protection of administrative data"
        }
      ],
      "securityIssues": [
        {
          "type": "authentication_anomaly",
          "test": "malformed_role_header",
          "description": "Test malformed role header handling"
        },
        {
          "type": "session_security",
          "test": "header_injection_attempt",
          "description": "Test header injection attempts"
        }
      ],
      "securityScore": 0
    }
  },
  "complianceGaps": {
    "soc2Compliance": {
      "audit_logging_completeness": {
        "category": "Security",
        "description": "Verify comprehensive audit logging is implemented",
        "compliant": false,
        "details": {
          "totalAuditLogs": 467,
          "hasRequiredFields": false,
          "sampleLog": {
            "id": "a2ff385f-d874-4747-8a41-5555c377c5d5",
            "action": "AUDIT_TEST",
            "resourceType": "system",
            "resourceId": "test-audit-123",
            "userId": "7898704c-ee5c-4ade-81f3-80a4388413fb",
            "ipAddress": null,
            "userAgent": null,
            "createdAt": "2025-07-27T01:01:45.909977+00:00",
            "metadata": null
          }
        }
      },
      "user_access_controls": {
        "category": "Security",
        "description": "Verify proper user access controls and role management",
        "compliant": false,
        "error": "GraphQL error: field 'active' not found in type: 'users'"
      },
      "data_processing_integrity": {
        "category": "Processing Integrity",
        "description": "Verify data processing controls and integrity checks",
        "compliant": false,
        "error": "GraphQL error: field 'hoursWorked' not found in type: 'timeEntries'"
      },
      "availability_controls": {
        "category": "Availability",
        "description": "Verify system availability and backup procedures",
        "compliant": true,
        "details": {
          "responseTime": 53,
          "isResponsive": true,
          "hasData": true,
          "aggregates": {
            "usersAggregate": {
              "aggregate": {
                "count": 7
              }
            },
            "clientsAggregate": {
              "aggregate": {
                "count": 11
              }
            },
            "payrollsAggregate": {
              "aggregate": {
                "count": 23
              }
            }
          }
        }
      },
      "confidentiality_controls": {
        "category": "Confidentiality",
        "description": "Verify data confidentiality and access restrictions",
        "compliant": "user_2yXhEiNJEhLR25QDFnqD4dzpkkL",
        "details": {
          "viewerHasLimitedAccess": true,
          "adminHasFullAccess": "user_2yXhEiNJEhLR25QDFnqD4dzpkkL",
          "viewerFields": [
            "id",
            "name",
            "email",
            "role"
          ],
          "adminFields": [
            "id",
            "name",
            "email",
            "role",
            "clerkUserId",
            "managerId"
          ]
        }
      }
    },
    "dataEncryption": {
      "database_connection_encryption": {
        "description": "Verify database connections use TLS encryption",
        "compliant": true,
        "details": {
          "hasuraUrl": "https://hasura.bytemy.com.au/v1/***",
          "usesHttps": true,
          "protocol": "HTTPS/TLS"
        }
      },
      "api_endpoint_encryption": {
        "description": "Verify API endpoints use HTTPS",
        "compliant": false,
        "details": {
          "baseUrl": "http://localhost:3000",
          "usesHttps": false,
          "protocol": "HTTP (Insecure)"
        }
      },
      "environment_variable_security": {
        "description": "Verify sensitive configuration is properly secured",
        "compliant": true,
        "details": {
          "totalSensitiveVars": 3,
          "secureVars": 3,
          "allVarsSecure": true,
          "missingVars": []
        }
      }
    },
    "auditTrails": {
      "comprehensive_audit_coverage": {
        "description": "Verify all critical operations are audited",
        "compliant": false,
        "details": {
          "totalLogs": 100,
          "hasActionCoverage": false,
          "hasResourceCoverage": false,
          "hasUserTracking": false,
          "hasIpTracking": false,
          "actionTypes": [
            "AUDIT_TEST",
            "invitation_status_change",
            "MIGRATION",
            "UPDATE",
            "INSERT"
          ],
          "resourceTypes": [
            "system",
            "user_invitation",
            "users",
            "user_roles",
            "role_permissions"
          ]
        }
      },
      "audit_log_integrity": {
        "description": "Verify audit logs cannot be modified and have proper retention",
        "compliant": false,
        "error": "GraphQL error: field 'updatedAt' not found in type: 'auditLogs'"
      },
      "audit_search_capabilities": {
        "description": "Verify audit logs can be searched and filtered effectively",
        "compliant": false,
        "details": {
          "userSearchWorks": false,
          "actionSearchWorks": false,
          "userSearchResults": 0,
          "actionSearchResults": 0
        }
      }
    },
    "dataRetention": {
      "user_data_lifecycle": {
        "description": "Verify user data has proper lifecycle management",
        "compliant": false,
        "error": "GraphQL error: field 'active' not found in type: 'users'"
      },
      "audit_log_retention": {
        "description": "Verify audit logs have appropriate retention periods",
        "compliant": false,
        "error": "GraphQL error: inconsistent arguments between multiple selections of field 'auditLogs'"
      }
    },
    "privacyCompliance": {
      "data_minimization": {
        "description": "Verify only necessary personal data is collected",
        "compliant": true,
        "details": {
          "totalUsers": 5,
          "hasEssentialFields": true,
          "userFields": [
            "id",
            "name",
            "email",
            "role",
            "isStaff",
            "createdAt"
          ]
        }
      },
      "access_transparency": {
        "description": "Verify users can access their personal data",
        "compliant": false,
        "error": "GraphQL error: missing session variable: \"x-hasura-user-id\""
      }
    },
    "gdprCompliance": {},
    "securityMonitoring": {},
    "backupRecovery": {},
    "summary": {
      "totalChecks": 15,
      "passedChecks": 5,
      "failedChecks": 10,
      "complianceScore": 0,
      "criticalFindings": [
        {
          "type": "soc2_compliance",
          "category": "Security",
          "test": "audit_logging_completeness",
          "description": "Verify comprehensive audit logging is implemented"
        },
        {
          "type": "soc2_compliance",
          "category": "Security",
          "test": "user_access_controls",
          "description": "Verify proper user access controls and role management"
        },
        {
          "type": "soc2_compliance",
          "category": "Processing Integrity",
          "test": "data_processing_integrity",
          "description": "Verify data processing controls and integrity checks"
        },
        {
          "type": "data_encryption",
          "test": "api_endpoint_encryption",
          "description": "Verify API endpoints use HTTPS"
        },
        {
          "type": "audit_trail",
          "test": "comprehensive_audit_coverage",
          "description": "Verify all critical operations are audited"
        },
        {
          "type": "audit_trail",
          "test": "audit_log_integrity",
          "description": "Verify audit logs cannot be modified and have proper retention"
        },
        {
          "type": "audit_trail",
          "test": "audit_search_capabilities",
          "description": "Verify audit logs can be searched and filtered effectively"
        }
      ],
      "complianceIssues": [
        {
          "type": "data_retention",
          "test": "user_data_lifecycle",
          "description": "Verify user data has proper lifecycle management"
        },
        {
          "type": "data_retention",
          "test": "audit_log_retention",
          "description": "Verify audit logs have appropriate retention periods"
        },
        {
          "type": "privacy_compliance",
          "test": "access_transparency",
          "description": "Verify users can access their personal data"
        }
      ],
      "recommendations": []
    }
  },
  "remediationPriorities": [
    {
      "priority": "CRITICAL",
      "timeline": "Immediate (1-2 weeks)",
      "items": [
        "Fix authorization bypass vulnerabilities",
        "Remove all hardcoded secrets",
        "Implement comprehensive audit logging",
        "Enable HTTPS for all API endpoints"
      ]
    },
    {
      "priority": "HIGH",
      "timeline": "Short-term (2-4 weeks)",
      "items": [
        "Implement proper field-level access controls",
        "Add comprehensive input validation",
        "Set up security monitoring and alerting",
        "Conduct penetration testing"
      ]
    },
    {
      "priority": "MEDIUM",
      "timeline": "Medium-term (1-3 months)",
      "items": [
        "Implement data encryption at rest",
        "Set up automated security scanning",
        "Develop incident response procedures",
        "Security training for development team"
      ]
    }
  ]
}