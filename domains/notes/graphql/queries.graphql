# Notes Domain Queries
# Security Classification: MEDIUM - Internal data with role-based access
# SOC2 Compliance: Row-level security enforced by Hasura permissions

query GetNotes($entity_id: uuid!, $entity_type: String!) {
  notes(
    where: {
      entity_id: { _eq: $entity_id }
      entity_type: { _eq: $entity_type }
    }
    order_by: { created_at: desc }
  ) {
    ...NoteWithUser
  }
}

query GetNotesBasic($entity_id: uuid!, $entity_type: String!) {
  notes(
    where: {
      entity_id: { _eq: $entity_id }
      entity_type: { _eq: $entity_type }
    }
    order_by: { created_at: desc }
  ) {
    ...NoteBasicInfo
  }
}

query GetImportantNotes($entity_id: uuid!, $entity_type: String!) {
  notes(
    where: { is_important: { _eq: true } }
    order_by: { created_at: desc }
  ) {
    ...NoteWithUser
  }
}

query GetNoteById($id: uuid!) {
  notes_by_pk(id: $id) {
    ...NoteWithUser
  }
}

# Audit query - limited fields for compliance logging
query GetNotesForAudit($entity_id: uuid!, $entity_type: String!) {
  notes(
    where: {
      entity_id: { _eq: $entity_id }
      entity_type: { _eq: $entity_type }
    }
    order_by: { created_at: desc }
  ) {
    ...NoteForAudit
  }
}

query GetNotesSimple {
  notes {
    id
    content
  }
}

# Extracted from inline GraphQL operations
query GetNotesExtracted($entity_type: String!, $entity_id: uuid!) {
  notes(
    where: {
      entity_id: { _eq: $entity_id }
      entity_type: { _eq: $entity_type }
    }
    order_by: { created_at: desc }
  ) {
    id
    content
    is_important
    created_at
    updated_at
    entity_type
    entity_id
    user {
      id
      name
    }
  }
}
