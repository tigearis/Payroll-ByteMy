# Payroll Fragments

fragment PayrollBasicInfo on payrolls {
  id
  name
  clientId
  cycleId
  dateTypeId
  primaryConsultantUserId
  backupConsultantUserId
  managerUserId
  employeeCount
  goLiveDate
}

fragment PayrollFullDetails on payrolls {
  id
  name
  employeeCount
  processingTime
  processingDaysBeforeEft
  payrollSystem
  dateValue
  versionNumber
  parentPayrollId
  goLiveDate
  supersededDate
  versionReason
  createdByUserId
}

fragment PayrollWithRelations on payrolls {
  ...PayrollFullDetails
  client {
    id
    name
  }
  payrollCycle {
    id
    name
  }
  payrollDateType {
    id
    name
  }
  primaryConsultant {
    id
    name
    email
  }
  backupConsultant {
    id
    name
    email
  }
  manager {
    id
    name
    email
  }
}

fragment PayrollWithClient on payrolls {
  ...PayrollBasicInfo
  client {
    id
    name
  }
}

fragment PayrollDate on payroll_dates {
  id
  payrollId
  originalEftDate
  adjustedEftDate
  processingDate
}

fragment PayrollWithDates on payrolls {
  ...PayrollWithRelations
  payrollDates(order_by: { adjustedEftDate: asc }) {
    ...PayrollDate
  }
}

# Performance-optimized fragments for Phase 2

fragment PayrollSummary on payrolls {
  id
  name
  status
  employeeCount
  updatedAt
}

fragment PayrollListItem on payrolls {
  ...PayrollSummary
  client {
    id
    name
  }
  primaryConsultant {
    id
    name
  }
  nextPayrollDate: payrollDates(
    where: { adjustedEftDate: { _gte: "now()" } }
    order_by: { adjustedEftDate: asc }
    limit: 1
  ) {
    adjustedEftDate
  }
}

fragment PayrollDashboardCard on payrolls {
  ...PayrollSummary
  client {
    id
    name
  }
  primaryConsultant {
    id
    name
  }
}

fragment PayrollTableRow on payrolls {
  ...PayrollListItem
  cycleId
  backupConsultant {
    id
    name
  }
  manager {
    id
    name
  }
}

fragment PayrollMinimal on payrolls {
  id
  name
  status
}

fragment PayrollWithNextDate on payrolls {
  ...PayrollSummary
  client {
    name
  }
  nextDate: payrollDates(
    where: { adjustedEftDate: { _gte: "now()" } }
    order_by: { adjustedEftDate: asc }
    limit: 1
  ) {
    adjustedEftDate
    processingDate
  }
}
