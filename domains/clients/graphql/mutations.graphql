# Clients Domain Mutations
# Security Classification: HIGH - PII and business-critical operations
# SOC2 Compliance: Full audit trail with user attribution

mutation CreateClient(
  $object: ClientsInsertInput!
) {
  insertClients(
    objects: [$object]
  ) {
    returning {
      ...ClientBase
    }
  }
}

mutation UpdateClient(
  $id: uuid!
  $set: ClientsSetInput!
) {
  updateClientsByPk(
    pkColumns: { id: $id }
    _set: $set
  ) {
    ...ClientBase
  }
}

mutation UpdateClientStatus($id: uuid!, $active: Boolean!) {
  updateClientsByPk(
    pkColumns: { id: $id }
    _set: { active: $active, updatedAt: "now()" }
  ) {
    ...ClientBase
  }
}

mutation DeactivateClient($id: uuid!) {
  updateClientsByPk(
    pkColumns: { id: $id }
    _set: { active: false, updatedAt: "now()" }
  ) {
    ...ClientBase
  }
}

mutation ActivateClient($id: uuid!) {
  updateClientsByPk(
    pkColumns: { id: $id }
    _set: { active: true, updatedAt: "now()" }
  ) {
    ...ClientBase
  }
}

# Soft delete - preserves audit trail
mutation ArchiveClient($id: uuid!) {
  updateClientsByPk(
    pkColumns: { id: $id }
    _set: { active: false, updatedAt: "now()" }
  ) {
    id
    name
  }
}

# Bulk operations for efficiency
mutation BulkUpdateClientStatus($where: ClientsBoolExp!, $set: ClientsSetInput!) {
  updateClients(
    where: $where
    _set: $set
  ) {
    returning {
      ...ClientBase
    }
    affectedRows
  }
}

mutation DeleteClient($id: uuid!) {
  updateClientsByPk(pkColumns: { id: $id }, _set: { active: false }) {
    id
    name
    active
  }
}
