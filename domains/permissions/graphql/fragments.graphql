# Permissions Domain Fragments

fragment ResourceCore on resources {
  id
  name
  displayName
  description
  createdAt
  updatedAt
}

fragment PermissionCore on permissions {
  id
  resourceId
  action
  description
  legacy_permission_name
  createdAt
  updatedAt
}

fragment PermissionWithResource on permissions {
  ...PermissionCore
  resource {
    ...ResourceCore
  }
}

fragment RoleCore on roles {
  id
  name
  displayName
  description
  priority
  isSystemRole
  createdAt
  updatedAt
}

fragment RoleWithPermissions on roles {
  ...RoleCore
  rolePermissions {
    id
    conditions
    permission {
      ...PermissionWithResource
    }
  }
  rolePermissions_aggregate {
    aggregate {
      count
    }
  }
}

fragment RolePermissionCore on role_permissions {
  id
  roleId
  permissionId
  conditions
  createdAt
  updatedAt
}

fragment RolePermissionWithDetails on role_permissions {
  ...RolePermissionCore
  role {
    ...RoleCore
  }
  permission {
    ...PermissionWithResource
  }
}

fragment UserRoleCore on user_roles {
  id
  userId
  roleId
  createdAt
  updatedAt
}

fragment UserRoleWithDetails on user_roles {
  ...UserRoleCore
  role {
    ...RoleWithPermissions
  }
  user {
    id
    name
    email
    isStaff
    isActive
  }
}

fragment FeatureFlagCore on feature_flags {
  id
  feature_name
  is_enabled
  allowed_roles
}

fragment AppSettingsCore on app_settings {
  id
  permissions
}
