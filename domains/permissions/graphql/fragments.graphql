# Permissions Domain Fragments
# Import shared fragments: ResourceCore, PermissionCore, RoleCore, UserRoleCore, RolePermissionCore

fragment PermissionsPermissionWithResource on permissions {
  ...PermissionCore
  legacy_permission_name
  resource {
    ...ResourceCore
  }
}

fragment RoleWithPermissions on roles {
  ...RoleCore
  rolePermissions {
    id
    conditions
    permission {
      ...PermissionsPermissionWithResource
    }
  }
  rolePermissions_aggregate {
    aggregate {
      count
    }
  }
}

# RolePermissionCore and UserRoleCore now moved to shared/graphql/fragments.graphql

fragment RolePermissionWithDetails on role_permissions {
  ...RolePermissionCore
  role {
    ...RoleCore
  }
  permission {
    ...PermissionsPermissionWithResource
  }
}

fragment UserRoleWithDetails on user_roles {
  ...UserRoleCore
  role {
    ...RoleWithPermissions
  }
  user {
    id
    name
    email
    isStaff
    isActive
  }
}

fragment FeatureFlagCore on feature_flags {
  id
  feature_name
  is_enabled
  allowed_roles
}

fragment AppSettingsCore on app_settings {
  id
  permissions
}
