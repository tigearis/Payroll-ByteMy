# Auth Domain Subscriptions
# Real-time updates for authentication and authorization changes

# Subscribe to user role changes
subscription UserRoleChanges($userId: uuid!) {
  user_roles(where: { user_id: { _eq: $userId } }) {
    ...UserRoleInfo
  }
}

# Subscribe to role permission changes for user's roles
subscription UserRolePermissionChanges($userId: uuid!) {
  user_roles(where: { user_id: { _eq: $userId } }) {
    role {
      role_permissions {
        ...RolePermissionInfo
      }
    }
  }
}

# Subscribe to role changes (admin only)
subscription RoleChanges {
  roles {
    ...BasicRoleInfo
    role_permissions {
      ...RolePermissionInfo
    }
  }
}

# Subscribe to user role assignment changes (audit substitute)
subscription UserRoleAuditEvents($userId: uuid = null) {
  user_roles(
    where: { user_id: { _eq: $userId } }
    order_by: { created_at: desc }
    limit: 50
  ) {
    id
    user_id
    role_id
    created_at
    updated_at
    role {
      name
      display_name
      description
    }
    user {
      email
    }
  }
}