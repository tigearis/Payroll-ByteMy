# Audit Domain Subscriptions

# Subscribe to new audit logs
subscription SubscribeToAuditLogs {
  auditLogs(order_by: { eventTime: desc }, limit: 1) {
    ...AuditLogWithUser
  }
}

# Subscribe to failed operations
subscription SubscribeToFailedOperations {
  auditLogs(
    where: { success: { _eq: false } }
    order_by: { eventTime: desc }
    limit: 10
  ) {
    ...AuditLogCore
  }
}

# Subscribe to user audit activity
subscription SubscribeToUserAuditActivity($user_id: uuid!) {
  auditLogs(
    where: { userId: { _eq: $user_id } }
    order_by: { eventTime: desc }
    limit: 20
  ) {
    ...AuditLogCore
  }
}

# Subscribe to data access logs
subscription SubscribeToDataAccessLogs {
  dataAccessLogs(order_by: { accessedAt: desc }, limit: 10) {
    ...DataAccessLogCore
  }
}
