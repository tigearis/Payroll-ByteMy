# Audit Domain Fragments

fragment AuditLogCore on auditLogs {
  id
  userId
  eventTime
  userEmail
  userRole
  action
  resourceType
  resourceId
  success
  ipAddress
  userAgent
  sessionId
  metadata
}

fragment AuditLogWithUser on auditLogs {
  ...AuditLogCore
  oldValues
  newValues
  errorMessage
  requestId
}

fragment DataAccessLogCore on dataAccessLogs {
  id
  userId
  accessedAt
  resourceType
  resourceId
  accessType
  dataClassification
  fieldsAccessed
  queryExecuted
  rowCount
  ipAddress
  sessionId
  metadata
}

fragment AuthEventCore on authEvents {
  id
  eventTime
  eventType
  userId
  userEmail
  ipAddress
  userAgent
  success
  failureReason
  metadata
}

fragment PermissionChangeCore on permissionChanges {
  id
  changedAt
  changedByUserId
  targetUserId
  targetRoleId
  changeType
  permissionType
  oldPermissions
  newPermissions
  reason
  approvedByUserId
  metadata
}
