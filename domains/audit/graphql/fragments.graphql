# Audit Domain Fragments

fragment AuditLogCore on audit_audit_log {
  id
  userId
  eventTime
  userEmail
  userRole
  action
  resourceType
  resourceId
  success
  ipAddress
  userAgent
  sessionId
  metadata
}

fragment AuditLogWithUser on audit_audit_log {
  ...AuditLogCore
  oldValues
  newValues
  error_message
  request_id
  created_at
}

fragment DataAccessLogCore on audit_data_access_log {
  id
  userId
  accessedAt
  resourceType
  resourceId
  accessType
  dataClassification
  fieldsAccessed
  queryExecuted
  rowCount
  ipAddress
  sessionId
  metadata
}

fragment AuthEventCore on audit_auth_events {
  id
  eventTime
  eventType
  userId
  userEmail
  ipAddress
  userAgent
  success
  failureReason
  metadata
  createdAt
}

fragment PermissionChangeCore on audit_permission_changes {
  id
  changedAt
  changedByUserId
  targetUserId
  targetRoleId
  changeType
  permissionType
  oldPermissions
  newPermissions
  reason
  approvedByUserId
  metadata
}
