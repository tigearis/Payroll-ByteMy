# Billing Domain Fragments - Enhanced Semi-Automated Billing System
# Security Classification: HIGH - Financial and billing data
# SOC2 Compliance: Financial data with strict audit requirements

# Service Catalog Fragment
fragment ServiceCatalogFragment on BillingPlan {
  id
  name
  description
  standardRate
  billingUnit
  category
  isActive
  currency
  createdAt
  updatedAt
}

# Client Service Agreement Fragment
fragment ClientServiceAgreementFragment on ClientBillingAssignment {
  id
  clientId
  billingPlanId
  customRate
  billingFrequency
  effectiveDate
  isEnabled
  isActive
  startDate
  endDate
  createdAt
  updatedAt
  billingPlan {
    ...ServiceCatalogFragment
  }
}

# Billing Item Fragment
fragment BillingItemFragment on BillingItems {
  id
  invoiceId
  description
  quantity
  amount
  totalAmount
  payrollId
  billingPlanId
  clientId
  serviceName
  hourlyRate
  isApproved
  approvalDate
  approvedBy
  confirmedAt
  confirmedBy
  notes
  createdAt
  updatedAt
}

# Time Entry Fragment
fragment TimeEntryFragment on TimeEntries {
  id
  staffUserId
  clientId
  payrollId
  billingItemId
  workDate
  hoursSpent
  description
  createdAt
  updatedAt
}

# Billing Period Fragment
fragment BillingPeriodFragment on BillingPeriods {
  id
  clientId
  periodStart
  periodEnd
  status
  createdAt
  updatedAt
}

# Enhanced Invoice Fragment
fragment BillingInvoiceFragment on BillingInvoice {
  id
  clientId
  billingPeriodStart
  billingPeriodEnd
  billingPeriodId
  issuedDate
  dueDate
  status
  totalAmount
  createdAt
  updatedAt
  client {
    id
    name
    contactPerson
    contactEmail
  }
  # billingPeriod relationship removed - using direct fields
  # billingPeriodStart, billingPeriodEnd, billingPeriodId already included above
}

# Invoice Item Fragment
fragment BillingInvoiceItemFragment on BillingInvoiceItem {
  id
  invoiceId
  descriptionOverride
  quantityHours
  hourlyRate
  netAmount
  totalAmount
  createdAt
}

# Payroll Billing Fragment
fragment PayrollBillingFragment on Payrolls {
  id
  name
  clientId
  employeeCount
  billingStatus
  estimatedRevenue
  actualRevenue
  estimatedHours
  actualHours
  profitMargin
  lastBilledDate
  processingTime
  createdAt
  updatedAt
  client {
    id
    name
  }
  billingItems {
    ...BillingItemFragment
  }
  timeEntries {
    ...TimeEntryFragment
  }
}