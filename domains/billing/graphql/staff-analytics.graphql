# Staff Analytics Summary

query GetStaffAnalytics(
  $limit: Int = 20
  $orderBy: [StaffAnalyticsSummaryOrderBy!] = [{ totalRevenue: DESC }]
  $activeOnly: Boolean = true
) {
  staffAnalytics: staffAnalyticsSummary(
    where: { isActive: { _eq: $activeOnly }, totalBillingItems: { _gt: 0 } }
    limit: $limit
    orderBy: $orderBy
  ) {
    staffUserId
    firstName
    lastName
    computedName
    email
    role
    isActive
    totalBillingItems
    totalRevenue
    averageItemValue
    approvedItems
    pendingItems
    approvalRatePercent
    totalHoursLogged
    averageDailyHours
    billableHours
    revenuePerHour
    revenuePerItem
    uniqueClientsServed
    primaryPayrollAssignments
    backupPayrollAssignments
    firstBillingItem
    lastBillingItem
  }

  staffSummary: staffAnalyticsSummaryAggregate(
    where: { isActive: { _eq: $activeOnly }, totalBillingItems: { _gt: 0 } }
  ) {
    aggregate {
      count
      sum {
        totalRevenue
        totalBillingItems
        totalHoursLogged
      }
      avg {
        revenuePerHour
        approvalRatePercent
      }
    }
  }
}

