
# Clients (Detailed Developer Guide)

This document provides a comprehensive technical overview of the clients feature. It is intended for developers who need to understand, maintain, and extend the client management functionality.

## 1. Data Model

The `clients` table is the central table for this feature. It stores all the information about a client.

-   **`clients`**: The main table for client records.
    -   `id` (uuid, PK): Unique identifier for the client.
    -   `name` (varchar): The name of the client.
    -   `contact_person` (varchar): The name of the primary contact person for the client.
    -   `contact_email` (varchar): The email address of the primary contact person.
    -   `contact_phone` (varchar): The phone number of the primary contact person.
    -   `active` (boolean): Whether the client is currently active.

## 2. Frontend Implementation

The frontend for the clients feature is built with Next.js, React, and Apollo Client.

### 2.1. Key Components and Hooks

-   **`app/(dashboard)/clients/page.tsx`**: The main entry point for the clients page. It is responsible for:
    -   Fetching the list of clients using the `useStrategicQuery` hook with the `GetAllClientsPaginatedDocument`.
    -   Managing the state of the page, including search terms, filters, and sorting.
    -   Rendering the `ClientsTable` component.
    -   Providing the UI for adding, editing, and deleting clients.

-   **`domains/clients/components/clients-table.tsx`**: This component is responsible for rendering the table of clients. It receives the list of clients as a prop and provides the UI for sorting, filtering, and pagination.

-   **`domains/clients/graphql/generated/graphql.ts`**: This file is generated by GraphQL Code Generator and contains the TypeScript types and Apollo Client hooks for all the GraphQL operations related to clients.

### 2.2. Data Flow

1.  The `ClientsPage` component fetches the list of clients from the GraphQL API using the `useStrategicQuery` hook.
2.  The user interacts with the UI to add, edit, or delete a client.
3.  When a user performs a CRUD operation, the appropriate GraphQL mutation is called.
4.  The `useStrategicQuery` hook automatically updates the cache, and the UI is updated to reflect the changes.

## 3. How to Extend and Modify

### 3.1. Adding a New Field to the Clients Table

1.  Add the new field to the `clients` table in `database/schema.sql`.
2.  Update the `GetAllClientsPaginatedDocument` query in the `domains/clients/graphql` directory to include the new field.
3.  Run `npm run codegen` to update the generated types and hooks.
4.  Add the new field to the `ClientsTable` component.

### 3.2. Adding a New Filter

1.  Add a new state variable to the `ClientsPage` component to store the value of the filter.
2.  Add a new UI element to the `ClientsPage` component to allow the user to set the value of the filter.
3.  Update the `filteredClients` variable in the `ClientsPage` component to filter the list of clients based on the value of the new filter.
